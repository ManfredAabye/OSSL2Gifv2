name: Build Executables for Windows, Linux & macOS

on:
  push:
    tags:
      - 'v*'           # Bei neuen Tags wie v1.0.0 automatisch starten
  workflow_dispatch:    # Manuell √ºber GitHub-UI startbar
    inputs:
      version:
        description: 'Version (z.B. v1.0.0)'
        required: true

jobs:
  build:
    strategy:
      fail-fast: false  # Wenn ein Build fehlschl√§gt, trotzdem weitermachen
      matrix:
        os: [windows-latest, ubuntu-latest, macos-latest]
        include:
          - os: windows-latest
            artifact_name: mein-programm-windows.exe
            asset_name: mein-programm-windows-amd64.exe
          - os: ubuntu-latest
            artifact_name: mein-programm-linux
            asset_name: mein-programm-linux-amd64
          - os: macos-latest
            artifact_name: mein-programm-macos
            asset_name: mein-programm-macos-amd64
    
    runs-on: ${{ matrix.os }}
    
    steps:
      - name: üì• Repository auschecken
        uses: actions/checkout@v4
      
      - name: üêç Python 3.13 einrichten
        uses: actions/setup-python@v5
        with:
          python-version: '3.13'
          
      - name: üì¶ Abh√§ngigkeiten installieren
        run: |
          python -m pip install --upgrade pip
          pip install pyinstaller
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
        shell: bash
      
      - name: üî® Executable bauen mit PyInstaller
        run: |
          pyinstaller --onefile --name mein-programm mein_hauptskript.py
        shell: bash
      
      - name: üìù Dateien umbenennen (plattformspezifisch)
        run: |
          if [ "$RUNNER_OS" == "Windows" ]; then
            mv dist/mein-programm.exe dist/${{ matrix.artifact_name }}
          else
            mv dist/mein-programm dist/${{ matrix.artifact_name }}
            chmod +x dist/${{ matrix.artifact_name }}
          fi
        shell: bash
      
      - name: üì§ Build-Artefakte hochladen
        uses: actions/upload-artifact@v4
        with:
          name: ${{ matrix.artifact_name }}
          path: dist/${{ matrix.artifact_name }}
